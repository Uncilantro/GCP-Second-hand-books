{"version":3,"file":"search.js","sources":["pages/search/search.vue","D:/develop/HBuilderX.4.24.2024072208/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2VhcmNoL3NlYXJjaC52dWU"],"sourcesContent":["<template>\r\n\t<view>\r\n\r\n\r\n\t\t<view class=\"bigtitle\">您的搜索关键词为: {{ keyword }}\r\n\t\t\t<view class=\"smalltitile\">\r\n\t\t\t\t搜索结果如下\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\r\n\t\t<view class=\"bottom-box\" v-for=\"(result, index) in searchResults\" :key=\"index\" @click=\"showPopup\"\r\n\t\t\tv-if=\"searchResults.length > 0\">\r\n\t\t\t<view class=\"tuijian\">\r\n\t\t\t\t<image class=\"huore\" src=\"../../static/火.png\" mode=\"\"></image>\r\n\t\t\t\t<image :src=\"result.img\" class=\"fengmian\"></image>\r\n\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t<view class=\"title\">\r\n\t\t\t\t\t\t{{ result.id }}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"smalltext\">\r\n\t\t\t\t\t\t适用专业: {{ result.type }}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"smalltext\">\r\n\t\t\t\t\t\t价格: <span\r\n\t\t\t\t\t\t\tstyle=\"color: crimson; font-weight: bolder; font-size: 36rpx;\">&nbsp;{{ result.jiage }}&nbsp;</span>元\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"smalltext\">\r\n\t\t\t\t\t\tISBN码:{{ result.isbn }}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"buttons\">\r\n\t\t\t\t\t<image class=\"shoucan\" @click.stop=\"addToCollection(result[dexin])\"\r\n\t\t\t\t\t\tsrc=\"../../static/ic_加入购物车2.png\" mode=\"\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<view v-else>\r\n\t\t\t<text>没有找到相关结果</text>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tkeyword: '',\r\n\t\t\t\tsearchResults: [],\r\n\t\t\t\tallData: []\r\n\t\t\t};\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\tconst encodedKeyword = options.keyword;\r\n\t\t\tconst decodedKeyword = decodeURIComponent(encodedKeyword);\r\n\t\t\tthis.keyword = decodedKeyword;\r\n\t\t\t// 页面加载时请求后端数据\r\n\t\t\tuni.request({\r\n\t\t\t\turl: 'http://localhost:3000/api/bookdate',\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\tthis.allData = res.data;\r\n\t\t\t\t\tthis.performSearch();\r\n\t\t\t\t},\r\n\t\t\t\tfail: () => {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '获取数据失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tperformSearch() {\r\n\t\t\t\t// 扁平化所有foods\r\n\t\t\t\tlet flatBooks = [];\r\n\t\t\t\tthis.allData.forEach(college => {\r\n\t\t\t\t\tif (Array.isArray(college.foods)) {\r\n\t\t\t\t\t\tflatBooks.push(...college.foods);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t// 模糊匹配：关键词出现在id/type/contact等字段即可\r\n\t\t\t\tconst kw = this.keyword.trim().toLowerCase();\r\n\t\t\t\tthis.searchResults = flatBooks.filter(food => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t(food.id && food.id.toLowerCase().includes(kw)) ||\r\n\t\t\t\t\t\t(food.type && food.type.toLowerCase().includes(kw)) ||\r\n\t\t\t\t\t\t(food.contact && food.contact.toLowerCase().includes(kw)) ||\r\n\t\t\t\t\t\t(food.isbn && String(food.isbn).toLowerCase().includes(kw))\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\taddToCollection(book) {\r\n\t\t\t\tlet collection = uni.getStorageSync('myCollection') || [];\r\n\t\t\t\tcollection.push(book);\r\n\t\t\t\tuni.setStorageSync('myCollection', collection);\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '已添加到购物车',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.shoucan {\r\n\t\tposition: relative;\r\n\t\tz-index: 100;\r\n\t\tfloat: right;\r\n\t\ttop: 60rpx;\r\n\t\tright: 20rpx;\r\n\t\twidth: 100rpx;\r\n\t\theight: 100rpx;\r\n\t}\r\n\t\r\n\t.smalltitile {\r\n\t\ttext-align: center;\r\n\t\tline-height: 60rpx;\r\n\t\tcolor: #fff;\r\n\t}\r\n\r\n\t.bigtitle {\r\n\t\tpadding-top: 20rpx;\r\n\t\twidth: 100%;\r\n\t\theight: 100rpx;\r\n\t\tposition: relative;\r\n\t\ttext-align: center;\r\n\t\tbackground-color: #3c7f54;\r\n\t\tcolor: #fff;\r\n\t\tfont-weight: bolder;\r\n\t}\r\n\r\n\t.fengmian {\r\n\t\twidth: 160rpx;\r\n\t\tbox-shadow: 15rpx 15rpx 15rpx 0 rgba(0, 0, 0, 0.5);\r\n\t\theight: 180rpx;\r\n\t\tmargin: 20rpx;\r\n\t}\r\n\r\n\t.huore {\r\n\t\twidth: 50rpx;\r\n\t\theight: 50rpx;\r\n\t\tposition: absolute;\r\n\t}\r\n\r\n\t.smalltext {\r\n\t\tline-height: 55rpx;\r\n\t\tfont-size: 30rpx;\r\n\t\tcolor: gray;\r\n\t\tfont-weight: bold;\r\n\t\tdisplay: -webkit-box;\r\n\t\t-webkit-box-orient: vertical;\r\n\t\t-webkit-line-clamp: 1;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t}\r\n\r\n\t.bottom-box {\r\n\t\twidth: 96%;\r\n\t\tmargin: 1rpx auto;\r\n\t\tmargin-top: 15rpx;\r\n\t\tborder: 3rpx solid #f3f3f3;\r\n\t\tborder-radius: 25rpx;\r\n\t\tbox-shadow: 5rpx 5rpx 5rpx 0 rgba(0, 0, 0, 0.5);\r\n\t\tpadding-top: 30rpx;\r\n\t}\r\n\r\n\t.tuijian {\r\n\t\tpadding-top: 20rpx;\r\n\t\tbackground-color: #fff;\r\n\t\tmargin: 2rpx auto;\r\n\t\theight: 250rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\twidth: 95%;\r\n\t\tbox-shadow: 15rpx 15rpx 15rpx 0 rgba(0, 0, 0, 0.5);\r\n\t\tbackground-color: #f3f3f3;\r\n\t\tdisplay: flex;\r\n\t\tbox-shadow: 5rpx 10rpx 10rpx gray;\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.right {\r\n\t\tmargin-left: 50rpx;\r\n\t\tline-height: 55rpx;\r\n\t}\r\n\r\n\t.title {\r\n\t\tfont-size: 40rpx;\r\n\t\tcolor: #000;\r\n\t\tfont-weight: bold;\r\n\t\tdisplay: -webkit-box;\r\n\t\t-webkit-box-orient: vertical;\r\n\t\t-webkit-line-clamp: 1;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/CHZ/Desktop/GCP-Second-hand-books/pages/search/search.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;;AA6CC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,SAAS;AAAA,MACT,eAAe,CAAE;AAAA,MACjB,SAAS,CAAC;AAAA;EAEX;AAAA,EACD,OAAO,SAAS;AACf,UAAM,iBAAiB,QAAQ;AAC/B,UAAM,iBAAiB,mBAAmB,cAAc;AACxD,SAAK,UAAU;AAEfA,kBAAAA,MAAI,QAAQ;AAAA,MACX,KAAK;AAAA,MACL,QAAQ;AAAA,MACR,SAAS,CAAC,QAAQ;AACjB,aAAK,UAAU,IAAI;AACnB,aAAK,cAAa;AAAA,MAClB;AAAA,MACD,MAAM,MAAM;AACXA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AAAA,MACF;AAAA,IACD,CAAC;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACR,gBAAgB;AAEf,UAAI,YAAY,CAAA;AAChB,WAAK,QAAQ,QAAQ,aAAW;AAC/B,YAAI,MAAM,QAAQ,QAAQ,KAAK,GAAG;AACjC,oBAAU,KAAK,GAAG,QAAQ,KAAK;AAAA,QAChC;AAAA,MACD,CAAC;AAED,YAAM,KAAK,KAAK,QAAQ,KAAM,EAAC,YAAW;AAC1C,WAAK,gBAAgB,UAAU,OAAO,UAAQ;AAC7C,eACE,KAAK,MAAM,KAAK,GAAG,YAAa,EAAC,SAAS,EAAE,KAC5C,KAAK,QAAQ,KAAK,KAAK,cAAc,SAAS,EAAE,KAChD,KAAK,WAAW,KAAK,QAAQ,cAAc,SAAS,EAAE,KACtD,KAAK,QAAQ,OAAO,KAAK,IAAI,EAAE,YAAa,EAAC,SAAS,EAAE;AAAA,MAE3D,CAAC;AAAA,IACD;AAAA,IACD,gBAAgB,MAAM;AACrB,UAAI,aAAaA,cAAG,MAAC,eAAe,cAAc,KAAK,CAAA;AACvD,iBAAW,KAAK,IAAI;AACpBA,oBAAAA,MAAI,eAAe,gBAAgB,UAAU;AAC7CA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,MACP,CAAC;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;ACtGD,GAAG,WAAW,eAAe;"}